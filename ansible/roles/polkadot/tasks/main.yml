---
- name: Create directory to clone Polkadot repo
  file:
    path: /polkadot/node
    state: directory
    mode: '0755'
  become: yes

- name: Clone Polkadot
  git:
    repo: https://github.com/paritytech/polkadot.git
    dest: /polkadot/node
  become: yes

- name: Run initialisation script and build Polkadot binary
  shell: |
      cd polkadot/node && sudo ./scripts/init.sh
  
- name: Build Polkadot binary
  shell: |
    sudo cargo build --release

- name: Run Polkadot
  shell: ./target/release/polkadot --name "Derek's Polkadot Node"
